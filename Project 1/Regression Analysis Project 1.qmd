---
title: "Regression Analysis Project 1"
author: "Brennan Chan, Tim McKinley, Connor Kelly"
format: pdf
editor: visual
---

# Project 1

## Part A:

### Fit a multiple regression model using Earnings as the dependent variable, and Events and Score as the independent variables

First lets load in the packages and data.

```{r, Messages=FALSE}
# Core packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(tidymodels))
golf = read_csv("Golf.csv", show_col_types = FALSE)

# Peek
summary(golf)
```

Now we can fit the multiple regression model

```{r}
# use set_engine(linear_reg(), "lm")
dat_recipe = recipe(Earnings ~ Events + Score, data = golf)
mod_spec = set_engine(linear_reg(), "lm")
fit_multi = fit(mod_spec, Earnings ~ Events + Score, data = golf)
lm_multi = fit_multi$fit 

```

### Comment on the global F-test, the individual t-tests, and the coefficient of determination.

```{r}
# Looking at the global F-Test
summary(lm_multi)
```

The fitted regression model is

$$
\widehat{\text{Earnings}} = 73{,}365{,}196 - 116{,}049(\text{Events}) - 965{,}039(\text{Score})
$$

#### Model Utility (F-Test)

Hypotheses:

$$
H_0: \beta_1 = \beta_2 = 0 \\
H_a: \text{At least one } \beta_j \neq 0
$$

From the summary output:\
$$
F(2,18) = 31.33,\quad p = 1.374\times10^{-6}
$$

Because the p-value is less than 0.05, we reject $H_0$. There is sufficient evidence that at least one of the slope coefficients differs from zero. Therefore, the regression model provides useful linear predictive information for Earnings.

#### Individual Slope Tests (t-Tests)

For each predictor, we test ($H_0:\beta\_j = 0$) versus ($H_a:\beta\_j \neq 0$).

| Predictor | Estimate | t-value | p-value   | Decision    |
|-----------|----------|---------|-----------|-------------|
| Events    | −116,049 | −2.668  | 0.0157    | Significant |
| Score     | −965,039 | −5.940  | 1.27×10⁻⁵ | Significant |

-   For Events: ($t = -2.67, p = 0.0157 < 0.05$). We reject ($H_0$) and conclude that Events has a significant linear relationship with Earnings when Score is held constant.\
-   For Score: ($t = -5.94, p < 0.001$). We reject ($H_0$) and conclude that Score is also a significant linear predictor of Earnings when Events is held constant.

Thus, both predictors make significant contributions to explaining variation in Earnings.

#### Coefficient of Determination

The coefficient of determination is ($R^2 = 0.7768$). This indicates that approximately 77.68% of the variability in Earnings is explained by the linear relationship with Events and Score.

#### Interpretation of Coefficients

-   The slope for Events (−116,049) indicates that, holding Score constant, each additional event is associated with an estimated decrease of \$116,049 in mean Earnings.\
-   The slope for Score (−965,039) indicates that, holding Events constant, a one-unit increase in Score is associated with an estimated decrease of \$965,039 in mean Earnings.\
-   The intercept (73,365,196) represents the predicted Earnings when both Events and Score equal 0, though this may not be meaningful in context.

### Give the equation of the model and the equation of the fitted model for the fit in item 2

Model Form: E(Earnings∣Events,Score)= $\beta_0 + \beta_1 Events + \beta_2 Score$

Where:

-   $\beta_0$ = Intercept = 73,365,196

-   $\beta_1$ = Coefficient for Events = -116,049

-   $\beta_2$ = Coefficient for Score = -965,039

Fitted model: E(Earnings∣Events,Score)= $73,365,196−116,049(Events)−965,039(Score)$

## Part B:

### Which of the independent variables, Events or Score, would you choose if you want only one predictor?

```{r}
mod_spec = set_engine(linear_reg(), "lm")

fit_events = fit(mod_spec, Earnings ~ Events, data = golf)
fit_score  = fit(mod_spec, Earnings ~ Score,  data = golf)

g_events = glance(fit_events$fit)
g_score  = glance(fit_score$fit)

g_events
```

```{r}
g_score
```

The model using Score has a substantially larger adjusted $R^2$ (0.6729 vs 0.3045). Therefore, if restricted to one predictor, we retain Score as the single predictor of Earnings.

### Fit a model with the independent variable chosen in the previous step. Comment on the global F-test, the individual t-test, and the coefficient of determination.

```{r}
mod_spec = set_engine(linear_reg(), "lm")
fit_score  = fit(mod_spec, Earnings ~ Score,  data = golf)
```

Using Score as the sole predictor lets see what the fit of the model looks like:

```{r}
summary(fit_score$fit)
```

Model form.

$$
E(\text{Earnings} \mid \text{Score})=\beta_0+\beta_1\,\text{Score}.
$$

Fitted model.\
$$
\widehat{\text{Earnings}} = 81{,}760{,}015 \;-\; 1{,}125{,}076\cdot \text{Score}.
$$

#### Model Utility (F-test)

Hypotheses. $$
H_0:\beta_1=0 \quad\text{vs}\quad H_a:\beta_1\neq 0.
$$

From the summary output:\
$$
F(1,19)=42.01,\quad p=3.279\times 10^{-6}.
$$\
Because the p-value is less than 0.05, we reject ($H_0$). There is sufficient evidence that the model provides useful linear predictive information for Earnings.

#### Individual Slope Test (t-test)

For the slope of Score: $$
t=-6.482,\quad p=3.28\times 10^{-6}.
$$\
Since ($p<0.05$), we reject ($H_0$) and conclude that Score is a significant linear predictor of Earnings.

#### Coefficient of Determination

$$
R^2 = 0.6886,\qquad \text{Adjusted }R^2 = 0.6722.
$$\
Thus, approximately 68.86% of the variation in Earnings is explained by its linear relationship with Score (about 67.22% after adjustment).

#### Interpretation of Coefficients

-   Slope ($\hat\beta_1=-1,125,076$). Holding other factors fixed (simple model), a one-unit increase in Score is associated with an estimated decrease of \$1,125,076 in the mean Earnings.\
-   Intercept ($\hat\beta_0=81{,}760,015$). Predicted Earnings when Score=0; this may not be meaningful in context.

### Equation of the model and the equation of the fitted model for the score as the predictor variable

Model Form: $E(\text{Earnings} \mid \text{Score}) = \beta_0 + \beta_1(\text{Score})$

Fitted Model: $\widehat{\text{Earnings}} = 81,760,015 - 1,125,076(\text{Score})$

-   The first equation (the “model”) shows the general population regression function using the unknown parameters ($\beta_0$) and ($\beta_1$).\
-   The second equation (the “fitted model”) replaces those unknown parameters with their estimates ($\hat\beta_0$) and ($\hat\beta_1$) obtained from the sample data.

## Part C:

### Compare the model that uses both predictors and the model that just uses one predictor.

| Model               | Predictors       | Adjusted ($R^2$) |
|:--------------------|:-----------------|:----------------:|
| Multiple Regression | Events and Score |      0.752       |
| Simple Regression   | Score only       |      0.672       |

The multiple regression model with Events and Score explains a larger proportion of the variation in Earnings (adjusted ($R^2 = 0.752$)) than the simple regression model using only Score (adjusted ($R^2 = 0.672$)).

Because the increase in explained variability is meaningful and both predictors are significant in the multiple model, we prefer the multiple regression model. This model provides greater explanatory power while still maintaining a relatively simple structure with only two predictors.
